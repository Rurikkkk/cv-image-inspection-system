# Image Markup Service

Микросервис отвечает за обработку изображений с помощью модели компьютерного зрения (YOLO), разметку объектов на изображениях и формирование списка объектов. Используется только для внутреннего взаимодействия с сервисом управления изображениями.

## Основные возможности
- Получение имени изображения для обработки
- Детекция объектов на изображении с помощью модели YOLO
- Генерация размеченного изображения с выделенными объектами
- Формирование списка объектов (обнаруженных классов)
- Возврат размеченного изображения и списка объектов сервису управления

## Запуск

### Локально:

1. Перейдите в директорию сервиса:
   ```sh
   cd src/backend/image_markup_service
   ```
2. Установите зависимости:
   ```sh
   pip install -r requirements.txt
   ```
3. Поместите файл модели YOLO в папку `yolo_model/` и переименуйте его в `yolo.pt`.
4. Запустите сервис:
   ```sh
   python app.py
   ```

### В Docker:

1. Перейдите в директорию сервиса:
   ```sh
   cd src/backend/image_markup_service
   ```
2. Поместите файл модели YOLO в папку `yolo_model/` и переименуйте его в `yolo.pt`.
3. Соберите Docker-образ:
   ```sh
   docker build -t image_markup_service .
   ```
4. Запустите контейнер:
   ```sh
   docker run -d -p 5002:5000 \
     -v $(pwd)/../data:/app/data \
     -v $(pwd)/yolo_model:/app/yolo_model \
     --name image_markup_service \
     image_markup_service
   ```

- Порт 5002 на хосте будет проброшен на 5000 внутри контейнера.
- Папка data будет общей с хостом (для хранения изображений и JSON).
- Папка yolo_model будет общей с хостом (для модели YOLO).

## Переменные и настройки
- Все пути к папкам изображений и URL микросервисов задаются в файле `src/backend/config.py`.
- Сервис по умолчанию запускается на порту 5000.

## API
- `POST /api/markup/process` — обработка изображения по имени файла (возвращает размеченное изображение и список объектов в заголовке)

## Зависимости
- Flask
- flask-cors
- ultralytics
- opencv-python-headless
- numpy

## Примечания
- Сервис не предназначен для прямого взаимодействия с пользователем.
- Для работы требуется файл модели YOLO.
